<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>पर्यायवाची शब्द (Synonyms)</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts: Mukta (for Nepali Readability) and Inter (for UI) -->
    <link href="https://fonts.googleapis.com/css2?family=Mukta:wght@400;600;700;800&family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        /* Modern Dark Theme Variables (Deep Blue/Teal Theme) */
        :root {
            --primary-bg: #0d121c; 
            --card-bg: #1a2330; 
            --accent-color: #06b6d4; /* Vibrant Cyan/Teal */
            --secondary-color: #34d399; /* Emerald Green for highlight */
            --text-color-light: #f3f4f6;
            --text-color-dark: #1f2937;
            --border-color: #374151;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--primary-bg);
            color: var(--text-color-light);
            transition: background-color 0.4s ease;
            min-height: 100vh;
        }

        /* Use Mukta for all Nepali Text content */
        .nepali-font {
            font-family: 'Mukta', Arial, sans-serif;
        }

        /* Header Styling */
        header {
            background-color: var(--card-bg);
            border-bottom: 5px solid var(--accent-color);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        /* Content Card Styling */
        .content-card {
            background-color: var(--card-bg);
            border: 1px solid var(--border-color);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            animation: fadeIn 1s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Table Styling */
        .synonym-table {
            border-collapse: separate;
            border-spacing: 0 8px; /* Space between rows */
        }

        .synonym-table th, .synonym-table td {
            padding: 12px 16px;
            border: none;
            /* Ensure text is legible on smaller screens */
            font-size: 1.05rem; 
        }

        .synonym-table th {
            background-color: var(--accent-color);
            color: var(--text-color-dark);
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            position: sticky;
            top: 0;
            z-index: 5;
        }
        
        /* Alternating row colors for high contrast */
        .synonym-table tr:nth-child(odd) td {
            background-color: #2c3a50; /* Slightly lighter dark */
        }

        .synonym-table tr:nth-child(even) td {
            background-color: #1f2937; /* Slightly darker dark */
        }
        
        .synonym-table tr:hover td {
            background-color: #3e4e66;
            transition: background-color 0.2s;
        }
        
        /* Search Box and Button */
        #searchButton {
            background-image: linear-gradient(90deg, var(--secondary-color) 0%, #059669 100%);
            color: var(--text-color-dark);
            box-shadow: 0 4px 15px -3px rgba(52, 211, 163, 0.6);
            transition: all 0.3s ease;
        }
        
        #searchButton:hover:not(:disabled) {
            transform: translateY(-1px);
            box-shadow: 0 6px 20px -5px rgba(52, 211, 163, 0.8);
        }

        #searchInput {
            border: 2px solid var(--border-color);
            background-color: #0f172a;
            color: var(--text-color-light);
        }
        
        #searchInput:focus {
             outline: none;
             border-color: var(--secondary-color);
             box-shadow: 0 0 0 3px rgba(52, 211, 163, 0.4);
        }
        
        /* Mobile Specific Styles */
        @media (max-width: 640px) {
            .synonym-table th, .synonym-table td {
                padding: 10px 8px;
                font-size: 0.95rem; /* Maximize visibility on small screens */
            }
            .synonym-table thead {
                font-size: 0.8rem;
            }
            .synonym-table tr td:first-child {
                font-weight: 700;
            }
        }
    </style>
</head>

<body class="flex flex-col">

    <!-- Header -->
    <header>
        <div class="max-w-7xl mx-auto py-4 px-4 sm:px-6 lg:px-8 text-center nepali-font">
            <h1 class="text-3xl sm:text-4xl font-extrabold text-accent-color">नेपाली व्याकरण</h1>
        </div>
    </header>

    <!-- Main Content -->
    <div class="flex-grow container mx-auto p-4 sm:p-6 lg:p-8">
        <div class="content-card max-w-5xl mx-auto p-6 sm:p-10 rounded-xl mt-6 mb-20">

            <h1 class="text-3xl sm:text-4xl font-extrabold text-center mb-4 text-secondary-color nepali-font">
                पर्यायवाची शब्द
            </h1>
            <p class="text-center text-base sm:text-lg text-gray-400 mb-8 nepali-font">
                'पर्यायवाची शब्द' भन्नाले **उस्तै अर्थ** लाग्ने शब्दहरू बुझिन्छ । यसले भाषिक ज्ञानलाई विस्तृत बनाउँछ।
            </p>

            <!-- Online Search Tool -->
            <div class="bg-primary-bg p-6 rounded-xl mb-10 border border-border-color shadow-inner">
                 <h2 class="text-xl font-bold mb-4 text-accent-color nepali-font">अनलाइन शब्दकोष खोज (Search Dictionary)</h2>
                 <div class="flex flex-col sm:flex-row gap-4">
                    <input type="text" id="searchInput" placeholder="यहाँ कुनै पनि नेपाली शब्द टाइप गर्नुहोस्..."
                        class="flex-grow p-3 rounded-lg nepali-font text-lg focus:ring-secondary-color focus:border-secondary-color transition" required>
                    <button id="searchButton" class="w-full sm:w-auto px-6 py-3 rounded-lg font-bold flex items-center justify-center text-lg nepali-font">
                        <svg id="searchIcon" class="w-5 h-5 mr-2 fill-current" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
                        </svg>
                        <span id="buttonText">खोज्नुहोस्</span>
                    </button>
                 </div>
                 
                 <!-- Search Result Display -->
                 <div id="searchResult" class="mt-6 p-4 rounded-lg bg-primary-bg border-2 border-secondary-color/50 hidden">
                    <h3 class="text-lg font-bold mb-2 text-secondary-color nepali-font" id="resultTitle"></h3>
                    <p class="text-base text-gray-300 nepali-font" id="resultContent"></p>
                    <div class="text-xs mt-3 text-gray-500 italic nepali-font" id="resultSource"></div>
                 </div>

                 <!-- Error/Loading Message -->
                 <p id="messageBox" class="mt-4 text-center text-sm text-red-400 nepali-font"></p>
            </div>
            
            <!-- Synonym Table -->
            <div class="overflow-x-auto">
                <table class="synonym-table min-w-full nepali-font">
                    <thead>
                        <tr>
                            <th class="rounded-tl-lg text-left w-1/3">शब्द (Word)</th>
                            <th class="rounded-tr-lg text-left w-2/3">पर्यायवाची शब्द (Synonyms)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr> <td>अंशु</td> <td>प्रकाश, किरण, ज्योति</td> </tr>
                        <tr> <td>अकर्मण्य</td> <td>अल्छी, निकम्मा, निष्क्रिय</td> </tr>
                        <tr> <td>आगो</td> <td>अनल, अग्नि, पावक, ज्वाला</td> </tr>
                        <tr> <td>आनन्द</td> <td>हर्ष, खुसी, मजा, प्रसन्नता, सुख, प्रमोद</td> </tr>
                        <tr> <td>आमा</td> <td>जननी, माता, मुमा</td> </tr>
                        <tr> <td>इच्छा</td> <td>आकांक्षा, कामना, अभिप्राय, चाहना, अभिलाषा</td> </tr>
                        <tr> <td>उषा</td> <td>बिहान, प्रभात, प्रातःकाल</td> </tr>
                        <tr> <td>उक्ति</td> <td>भनाइ, कथन, कुरा, वाणी</td> </tr>
                        <tr> <td>उग्र</td> <td>डरलाग्दो, भयङ्कर, चर्को, कडा, प्रचण्ड</td> </tr>
                        <tr> <td>उचित</td> <td>उपयुक्त, अनुकूल, सुहाउँदो, योग्य</td> </tr>
                        <tr> <td>ऐश</td> <td>आराम, चैन, विलास, मोज, सुखभोग</td> </tr>
                        <tr> <td>औसत</td> <td>सालाखाला, सरदर, साधारण, मध्यम</td> </tr>
                        <tr> <td>कक्षा</td> <td>स्तर, दर्जा, श्रेणी, वर्ग</td> </tr>
                        <tr> <td>दास</td> <td>नोकर, सेवक, कमारो, भृत्य</td> </tr>
                        <tr> <td>दृढ</td> <td>अचल, अडिग, टिकाउ, स्थिर</td> </tr>
                        <tr> <td>देवालय</td> <td>देवल, मन्दिर, देवगृह, पूजास्थल</td> </tr>
                        <tr> <td>दैत्य</td> <td>असुर, राक्षस, दानव</td> </tr>
                        <tr> <td>दिन</td> <td>दिउँसो, दिवस, वार</td> </tr>
                        <tr> <td>तपस्या</td> <td>तप, आराधना, तपस, साधना</td> </tr>
                        <tr> <td>टुक्रा</td> <td>कण, अंश, खण्ड</td> </tr>
                        <tr> <td>डर</td> <td>त्रास, भय, सन्त्रास</td> </tr>
                        <tr> <td>दाम</td> <td>मुद्रा, द्रव्य, रुपैयाँ, सम्पत्ति</td> </tr>
                        <tr> <td>प्रकार</td> <td>ढङ्ग, काइदा, किसिम, भेद</td> </tr>
                        <tr> <td>प्रतीक</td> <td>चिन्ह, लक्षण, निसाना, संकेत</td> </tr>
                        <tr> <td>प्वाल</td> <td>दुलो, छिद्र, रन्ध्र</td> </tr>
                        <tr> <td>फूल</td> <td>पुष्प, कुसुम, सुमन, प्रसून</td> </tr>
                        <tr> <td>फोहोर</td> <td>मलिन, गन्धा, मैला, अशुद्ध, विकार</td> </tr>
                        <tr> <td>बल</td> <td>शक्ति, ताकत, क्षमता, पाइन</td> </tr>
                        <tr> <td>बादल</td> <td>मेघ, जलद, घन, पयोधर</td> </tr>
                        <tr> <td>युद्ध</td> <td>लडाइँ, सङ्ग्राम, कटक, रण</td> </tr>
                        <tr> <td>रोग</td> <td>व्यथा, बिमार, व्याधि</td> </tr>
                        <tr> <td>रुख</td> <td>वृक्ष, द्रुम, तरु, पादप</td> </tr>
                        <tr> <td>वर्ष</td> <td>संवत्, साल, अब्द</td> </tr>
                        <tr> <td>विचार</td> <td>सोचाइ, चिन्तन, मनन, संकल्प</td> </tr>
                        <tr> <td>शाखा</td> <td>विभाग, हाँगा, अङ्ग, डारी</td> </tr>
                        <tr> <td>शुल्क</td> <td>कर, महसुल, दस्तुर</td> </tr>
                        <tr> <td>सबै</td> <td>जम्मै, सारा, सम्पूर्ण, भएभरको</td> </tr>
                        <tr> <td>बाटो</td> <td>मार्ग, पथ, सडक</td> </tr>
                    </tbody>
                </table>
            </div>

            <br><br><br>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-card-bg text-gray-500 p-4 text-center mt-auto shadow-inner border-t border-border-color">
        <p class="text-xs sm:text-sm nepali-font">&copy; 2024 नेपाली व्याकरण | पर्यायवाची शब्द</p>
    </footer>

    <!-- JavaScript for Online Search Functionality -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const searchInput = document.getElementById('searchInput');
            const searchButton = document.getElementById('searchButton');
            const buttonText = document.getElementById('buttonText');
            const searchIcon = document.getElementById('searchIcon');
            const searchResult = document.getElementById('searchResult');
            const resultTitle = document.getElementById('resultTitle');
            const resultContent = document.getElementById('resultContent');
            const resultSource = document.getElementById('resultSource');
            const messageBox = document.getElementById('messageBox');

            // API Key provided by the user
            const apiKey = "AIzaSyAsMYxIz5tfVJ1qXG71RnpoxP67OfpXIUc"; 
            const model = 'gemini-2.5-flash-preview-05-20';
            const apiUrlBase = `https://generativelanguage.googleapis.com/v1beta/models/${model}:generateContent`;

            const displayMessage = (message, isError = false) => {
                messageBox.textContent = message;
                messageBox.classList.remove('text-red-400', 'text-secondary-color');
                messageBox.classList.add(isError ? 'text-red-400' : 'text-secondary-color');
            };

            const clearUI = () => {
                searchResult.classList.add('hidden');
                resultTitle.textContent = '';
                resultContent.textContent = '';
                resultSource.textContent = '';
                messageBox.textContent = '';
            };

            // Utility function for exponential backoff retry logic (Mandatory)
            const exponentialBackoffFetch = async (url, options, maxRetries = 5) => {
                for (let i = 0; i < maxRetries; i++) {
                    try {
                        const response = await fetch(url, options);
                        if (response.ok) {
                            return response;
                        }
                        if (response.status === 429 || response.status >= 500) {
                            throw new Error(`Server error: ${response.status}`);
                        }
                        const errorData = await response.json().catch(() => ({}));
                        throw new Error(errorData.error ? errorData.error.message : `HTTP error! Status: ${response.status}`);
                    } catch (error) {
                        if (i === maxRetries - 1) {
                            throw error;
                        }
                        const delay = Math.pow(2, i) * 1000 + Math.random() * 500;
                        await new Promise(resolve => setTimeout(resolve, delay));
                    }
                }
            };

            const searchSynonym = async () => {
                const word = searchInput.value.trim();
                if (!word) {
                    displayMessage('त्रुटि: कृपया खोज्नको लागि शब्द प्रविष्ट गर्नुहोस्।', true);
                    clearUI();
                    searchResult.classList.add('hidden');
                    return;
                }
                
                clearUI();
                displayMessage(`शब्द '${word}' को लागि खोजिँदै...`);

                // UI Loading State
                searchButton.disabled = true;
                buttonText.textContent = 'खोजिँदै...';
                searchIcon.classList.add('hidden');
                messageBox.classList.add('animate-pulse');

                const apiUrl = `${apiUrlBase}?key=${apiKey}`;

                // Instruct the model to act as a Nepali Grammarian/Lexicographer and use search grounding
                const systemPrompt = `You are a professional Nepali lexicographer and grammarian. For the input word provided, use the Google Search tool to find its primary meaning (अर्थ), its most common synonyms (पर्यायवाची शब्द), and present the output in a clean Nepali paragraph. Do not include any prefixes, suffixes, or conversational text.`;
                const userQuery = `Find the meaning (अर्थ) and synonyms (पर्यायवाची शब्द) for the Nepali word: "${word}"`;

                const payload = {
                    contents: [{ parts: [{ text: userQuery }] }],
                    tools: [{ "google_search": {} }],
                    systemInstruction: { parts: [{ text: systemPrompt }] },
                };

                try {
                    const response = await exponentialBackoffFetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    const result = await response.json();
                    const candidate = result.candidates?.[0];
                    let translatedText = '';
                    let sources = [];

                    if (candidate && candidate.content?.parts?.[0]?.text) {
                        translatedText = candidate.content.parts[0].text.trim();
                        
                        // Extract grounding sources (citations)
                        const groundingMetadata = candidate.groundingMetadata;
                        if (groundingMetadata && groundingMetadata.groundingAttributions) {
                            sources = groundingMetadata.groundingAttributions
                                .map(attr => ({
                                    uri: attr.web?.uri,
                                    title: attr.web?.title,
                                }))
                                .filter(source => source.uri && source.title); 
                        }

                        // Display Result
                        resultTitle.textContent = `खोज परिणाम: '${word}'`;
                        resultContent.textContent = translatedText;
                        
                        if (sources.length > 0) {
                            resultSource.innerHTML = 'स्रोतहरू: ' + sources.map((s, index) => 
                                `<a href="${s.uri}" target="_blank" class="text-link-color hover:underline">${s.title}</a>`
                            ).join(' | ');
                        } else {
                            resultSource.textContent = 'स्रोत: अनलाइन एआई मोडेल';
                        }
                        
                        searchResult.classList.remove('hidden');
                        displayMessage('सफलता: खोज परिणाम प्राप्त भयो।', false);

                    } else {
                        throw new Error('API प्रतिक्रियामा सामग्री पाइएन।');
                    }

                } catch (error) {
                    let errorMessage;
                    const errorString = error.toString();

                    if (errorString.includes('403') || errorString.includes('authentication')) {
                        errorMessage = 'प्रमाणीकरण त्रुटि (403): API कुञ्जीमा समस्या छ वा यसलाई पहुँच अनुमति छैन।';
                    } else if (errorString.includes('Server error')) {
                        errorMessage = `सर्भर त्रुटि: API कल असफल भयो। (${error.message.substring(0, 50)}...)`;
                    } else {
                        errorMessage = 'नेटवर्क त्रुटि: कृपया आफ्नो इन्टरनेट जडान जाँच गर्नुहोस्।';
                    }

                    resultTitle.textContent = `खोज असफल: '${word}'`;
                    resultContent.textContent = 'क्षमा गर्नुहोस्, तपाईंले खोज्नुभएको शब्दको अर्थ र पर्यायवाची शब्दहरू अहिले फेला पार्न सकिएन।';
                    searchResult.classList.remove('hidden');
                    displayMessage(errorMessage, true);
                    console.error("Search failed:", error);

                } finally {
                    // Reset UI State
                    searchButton.disabled = false;
                    buttonText.textContent = 'खोज्नुहोस्';
                    searchIcon.classList.remove('hidden');
                    messageBox.classList.remove('animate-pulse');
                }
            };

            searchButton.addEventListener('click', searchSynonym);
            searchInput.addEventListener('keydown', (e) => {
                if (e.key === 'Enter') {
                    searchSynonym();
                }
            });
        });
    </script>
</body>

</html>
